function p=IdealPApprox(EOverN,n,corr)% Ideal's prob of correct id of 1 of n orthogonal signals with energy E% return value is proportion correct p.% E is signal energy. % n is number of orthogonal equal-energy, signals (if corr=0).% corr is the (equal) correlation among the equal-energy signals.% NOT YET IMPLEMENTED: Actually, there's no need to simplify. We can% calculate the covariance function of all the letters in the alphabet and% use the MATLAB function mvncdf to implement the multivariate normal% integral specified in Eq. A9 of Pelli et al. (2006). That probability is% for a given signal, so we would average it across all the possible% signals.if nargin<1    EOverN=0;endif nargin<2    n=1;endif nargin<3    corr=0;enddc=.1;c=-20:dc:20;p=EOverN;EOverN=max(EOverN,0);EOverN=EOverN*(1-corr);for i=1:length(EOverN(:))    p(i)=dc*normpdf(c,0,1)*normcdf(c,-sqrt(EOverN(i)),1)'.^(n-1);%     dprime=sqrt(2)*norminv(p);end% plot(E.^0.5,sqrt(2)*norminv(IdealP(E,2)))